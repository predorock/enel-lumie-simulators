{
    "pages": [
        {
            "id": "client-selection",
            "title": "Chiedi al cliente di raccontarti qualcosa sulla sua casa",
            "step": 1,
            "fullPage": false,
            "showStepper": true,
            "showNavigation": true,
            "showBackgroundDecoration": true,
            "validationRules": {
                "required": [
                    "formData.storeCity"
                ]
            },
            "navigationHooks": {
                "beforeNext": "",
                "afterNext": "",
                "beforePrevious": "",
                "afterPrevious": ""
            },
            "leftPanelComponents": [
                {
                    "type": "Image",
                    "props": {
                        "src": "italy",
                        "alt": "Italy",
                        "className": "z-10 relative w-auto h-auto",
                        "containerClassName": "flex justify-center items-center mt-16 h-full"
                    }
                }
            ],
            "components": [
                {
                    "type": "DescriptionBox",
                    "props": {
                        "title": "Dove si trova la casa del cliente?",
                        "description": "Spiega che con questa informazione possiamo tenere in considerazione fattori climatici, geografici e ambientali, e proporre stime di risparmio più precise."
                    }
                },
                {
                    "type": "AutocompleteInput",
                    "props": {
                        "placeholder": "Città",
                        "label": "Città",
                        "stateProperty": "storeCity",
                        "loadDataAction": "loadCities",
                        "stateSlice": "cityState",
                        "searchable": true,
                        "searchPlaceholder": "Cerca città...",
                        "maxHeight": "250px"
                    }
                },
                {
                    "type": "Divider",
                    "props": {
                        "color": "#c2cddd",
                        "className": "py-4"
                    }
                },
                {
                    "type": "Toggle",
                    "props": {
                        "label": "Si tratta di un cliente Enel Luce e Gas?",
                        "className": "font-enel-bold",
                        "stateProperty": "isEnelCustomer",
                        "initialValue": false
                    }
                }
            ]
        },
        {
            "id": "checklist-configuratore",
            "title": "Configurate insieme il climatizzatore!",
            "step": 2,
            "fullPage": false,
            "showStepper": true,
            "showNavigation": true,
            "showBackgroundDecoration": true,
            "validationRules": {
                "custom": [
                    {
                        "type": "minQuantity",
                        "property": "formData.airconditioningQuantities",
                        "minTotal": 1,
                        "errorMessage": "Almeno un climatizzatore deve essere selezionato"
                    },
                    {
                        "type": "airConditioningConfig",
                        "property": "formData.airConditioningConfigs",
                        "dependsOn": "formData.airconditioningQuantities",
                        "errorMessage": "Completare la configurazione per tutti i climatizzatori selezionati"
                    }
                ]
            },
            "navigationHooks": {
                "beforeNext": "generateSplitPages",
                "afterNext": "",
                "beforePrevious": "",
                "afterPrevious": ""
            },
            "leftPanelComponents": [
                {
                    "type": "Image",
                    "props": {
                        "src": "condizionatore-big",
                        "alt": "Condizionatore",
                        "className": "z-10 relative w-auto h-auto max-w-[280px] mt-8",
                        "containerClassName": "flex justify-center items-center flex-1"
                    }
                },
                {
                    "type": "CostSummary",
                    "props": {
                        "containerClassName": "mt-auto mb-4 self-end w-full"
                    }
                }
            ],
            "components": [
                {
                    "type": "DescriptionBox",
                    "props": {
                        "title": "Quanti impianti vuole acquistare il cliente?",
                        "description": "Il cliente può indicare un massimo di 5 split totali"
                    }
                },
                {
                    "type": "SplitterQtyConfigurator",
                    "props": {
                        "items": [
                            {
                                "key": "monosplit",
                                "label": "Monosplit"
                            },
                            {
                                "key": "dualsplit",
                                "label": "Dualsplit"
                            },
                            {
                                "key": "trialsplit",
                                "label": "Trialsplit"
                            }
                        ],
                        "min": 0,
                        "max": 5,
                        "totalMax": 5,
                        "stateProperty": "airconditioningQuantities",
                        "calculationType": "purchase",
                        "showPriceDisplay": false
                    }
                },
                {
                    "type": "Divider",
                    "props": {
                        "className": "py-6"
                    },
                    "renderConditions": {
                        "hasQuantities": "formData.airconditioningQuantities"
                    }
                },
                {
                    "type": "AirConditioningConfigurator",
                    "props": {
                        "stateProperty": "airConditioningConfigs",
                        "installationTypes": [
                            {
                                "value": "nuova_con_predisposizione",
                                "label": "Con Predisposizione"
                            },
                            {
                                "value": "nuova_senza_predisposizione",
                                "label": "Senza Predisposizione"
                            }
                        ],
                        "infoIconKey": "airConditioningInfo"
                    },
                    "renderConditions": {
                        "hasQuantities": "formData.airconditioningQuantities"
                    }
                },
                {
                    "type": "InfoBanner",
                    "props": {
                        "title": "Il cliente non ha predisposizioni riutilizzabili o installazioni con unità interna in adiacenza a quella esterna?",
                        "description": "Spiegagli che le connessioni tra unità esterna ed interna sono realizzate in canaline a vista",
                        "icon": "info",
                        "variant": "info"
                    },
                    "renderConditions": {
                        "atLeastOneOf": {
                            "items": "formData.airConditioningConfigs",
                            "property": "installationType",
                            "value": "nuova_senza_predisposizione"
                        }
                    }
                }
            ]
        },
        {
            "id": "servizi-manutenzione",
            "title": "Configurate insieme il climatizzatore!",
            "step": 2,
            "fullPage": false,
            "showStepper": true,
            "showNavigation": true,
            "showBackgroundDecoration": true,
            "validationRules": {
                "conditional": [
                    {
                        "condition": {
                            "property": "needsRemoval",
                            "equals": true
                        },
                        "then": {
                            "type": "minQuantity",
                            "property": "removalQuantities",
                            "minTotal": 1,
                            "errorMessage": "Seleziona almeno un impianto da smontare"
                        }
                    },
                    {
                        "condition": {
                            "property": "wantsCleaning",
                            "equals": true
                        },
                        "then": {
                            "type": "minQuantity",
                            "property": "cleaningQuantities",
                            "minTotal": 1,
                            "errorMessage": "Seleziona almeno un impianto da lavare"
                        }
                    }
                ]
            },
            "navigationHooks": {
                "beforeNext": "",
                "afterNext": "",
                "beforePrevious": "",
                "afterPrevious": ""
            },
            "leftPanelComponents": [
                {
                    "type": "Image",
                    "props": {
                        "src": "condizionatore-big",
                        "alt": "Condizionatore",
                        "className": "z-10 relative w-auto h-auto max-w-[280px] mt-8",
                        "containerClassName": "flex justify-center items-center flex-1"
                    }
                },
                {
                    "type": "CostSummary",
                    "props": {
                        "containerClassName": "mt-auto mb-4 self-end w-full"
                    }
                }
            ],
            "components": [
                {
                    "type": "DescriptionBox",
                    "props": {
                        "title": "Il cliente ha necessità di smontare dei climatizzatori già installati?",
                        "description": "",
                        "className": "mb-6"
                    }
                },
                {
                    "type": "Toggle",
                    "props": {
                        "label": "Il cliente deve smontare dei climatizzatori installati in precedenza",
                        "stateProperty": "needsRemoval",
                        "initialValue": false,
                        "storeAction": "checkRemoval",
                        "className": "mb-6"
                    }
                },
                {
                    "type": "DescriptionBox",
                    "props": {
                        "title": "Indica quanti impianti devono essere smontati",
                        "description": "",
                        "className": "mb-6"
                    },
                    "renderConditions": {
                        "equals": {
                            "property": "formData.needsRemoval",
                            "value": true
                        }
                    }
                },
                {
                    "type": "SplitterQtyConfigurator",
                    "props": {
                        "items": [
                            {
                                "key": "monosplit",
                                "label": "Monosplit"
                            },
                            {
                                "key": "dualsplit",
                                "label": "Dualsplit"
                            },
                            {
                                "key": "trialsplit",
                                "label": "Trialsplit"
                            }
                        ],
                        "min": 0,
                        "max": 10,
                        "totalMax": 10,
                        "stateProperty": "removalQuantities",
                        "calculationType": "removal",
                        "showPriceDisplay": true,
                        "className": "mb-6"
                    },
                    "renderConditions": {
                        "equals": {
                            "property": "formData.needsRemoval",
                            "value": true
                        }
                    }
                },
                {
                    "type": "Divider",
                    "props": {
                        "className": "py-6"
                    }
                },
                {
                    "type": "DescriptionBox",
                    "props": {
                        "title": "Consiglia al cliente di effettuare il lavaggio dell'impianto",
                        "className": "mb-6"
                    }
                },
                {
                    "type": "Toggle",
                    "props": {
                        "label": "Il cliente vuole effettuare il lavaggio degli impianti?",
                        "stateProperty": "wantsCleaning",
                        "initialValue": false,
                        "storeAction": "checkCleaning",
                        "className": "mb-6"
                    }
                },
                {
                    "type": "DescriptionBox",
                    "props": {
                        "title": "Indica quanti impianti devono essere lavati",
                        "className": "mb-6"
                    },
                    "renderConditions": {
                        "equals": {
                            "property": "formData.wantsCleaning",
                            "value": true
                        }
                    }
                },
                {
                    "type": "SplitterQtyConfigurator",
                    "props": {
                        "items": [
                            {
                                "key": "monosplit",
                                "label": "Monosplit"
                            },
                            {
                                "key": "dualsplit",
                                "label": "Dualsplit"
                            },
                            {
                                "key": "trialsplit",
                                "label": "Trialsplit"
                            }
                        ],
                        "min": 0,
                        "max": 10,
                        "totalMax": 10,
                        "stateProperty": "cleaningQuantities",
                        "calculationType": "cleaning",
                        "showPriceDisplay": true,
                        "className": "mb-6"
                    },
                    "renderConditions": {
                        "equals": {
                            "property": "formData.wantsCleaning",
                            "value": true
                        }
                    }
                }
            ]
        },
        {
            "id": "canalizzazioni-configuratore",
            "title": "Configurate insieme il climatizzatore!",
            "step": 2,
            "fullPage": false,
            "showStepper": true,
            "showNavigation": true,
            "showBackgroundDecoration": true,
            "validationRules": {},
            "navigationOverride": {},
            "navigationHooks": {
                "beforeNext": "",
                "afterNext": "",
                "beforePrevious": "",
                "afterPrevious": ""
            },
            "leftPanelComponents": [
                {
                    "type": "Image",
                    "props": {
                        "src": "condizionatore-big",
                        "alt": "Condizionatore",
                        "className": "z-10 relative w-auto h-auto max-w-[280px] mt-8",
                        "containerClassName": "flex justify-center items-center flex-1"
                    }
                },
                {
                    "type": "CostSummary",
                    "props": {
                        "containerClassName": "mt-auto mb-4 self-end w-full"
                    }
                }
            ],
            "components": [
                {
                    "type": "DescriptionBox",
                    "props": {
                        "title": "Il cliente ha bisogno di acquistare canalizzazioni tra unità interne e quelle esterne?",
                        "description": "Necessarie per le nuove installazioni e in caso di modifiche alle combinazioni di impianti preesistenti."
                    }
                },
                {
                    "type": "DuctworkConfigurator",
                    "props": {
                        "items": [
                            {
                                "key": "monosplit",
                                "label": "Monosplit",
                                "type": "mono"
                            },
                            {
                                "key": "dualsplit",
                                "label": "Dualsplit",
                                "type": "dual"
                            },
                            {
                                "key": "trialsplit",
                                "label": "Trialsplit",
                                "type": "trial"
                            }
                        ],
                        "ductworkOptions": {
                            "monosplit": [
                                {
                                    "value": 1,
                                    "range": "3m - 9m",
                                    "description": "(1 modulo canalizzazione)"
                                },
                                {
                                    "value": 2,
                                    "range": "9m - 15m",
                                    "description": "(2 moduli canalizzazione)"
                                },
                                {
                                    "value": 3,
                                    "range": "15m - 21m",
                                    "description": "(3 moduli canalizzazione)"
                                },
                                {
                                    "value": 4,
                                    "range": "21m - 27m",
                                    "description": "(4 moduli canalizzazione)"
                                },
                                {
                                    "value": 5,
                                    "range": "27m - 33m",
                                    "description": "(5 moduli canalizzazione)"
                                }
                            ],
                            "dualsplit": [
                                {
                                    "value": 1,
                                    "range": "4m - 10m",
                                    "description": "(1 modulo canalizzazione)"
                                },
                                {
                                    "value": 2,
                                    "range": "10m - 16m",
                                    "description": "(2 moduli canalizzazione)"
                                },
                                {
                                    "value": 3,
                                    "range": "16m - 22m",
                                    "description": "(3 moduli canalizzazione)"
                                },
                                {
                                    "value": 4,
                                    "range": "22m - 28m",
                                    "description": "(4 moduli canalizzazione)"
                                },
                                {
                                    "value": 5,
                                    "range": "28m - 34m",
                                    "description": "(5 moduli canalizzazione)"
                                }
                            ],
                            "trialsplit": [
                                {
                                    "value": 1,
                                    "range": "6m - 12m",
                                    "description": "(1 modulo canalizzazione)"
                                },
                                {
                                    "value": 2,
                                    "range": "12m - 18m",
                                    "description": "(2 moduli canalizzazione)"
                                },
                                {
                                    "value": 3,
                                    "range": "18m - 24m",
                                    "description": "(3 moduli canalizzazione)"
                                },
                                {
                                    "value": 4,
                                    "range": "24m - 30m",
                                    "description": "(4 moduli canalizzazione)"
                                },
                                {
                                    "value": 5,
                                    "range": "30m - 36m",
                                    "description": "(5 moduli canalizzazione)"
                                }
                            ]
                        },
                        "stateProperty": "ductworkQuantities"
                    }
                }
            ]
        },
        {
            "id": "lancio-simulazione",
            "title": "Stiamo creando il preventivo per il tuo cliente",
            "step": 3,
            "fullPage": false,
            "showStepper": true,
            "showNavigation": true,
            "showBackgroundDecoration": true,
            "validationRules": {},
            "navigationHooks": {
                "beforeNext": "",
                "afterNext": "",
                "beforePrevious": "",
                "afterPrevious": ""
            },
            "leftPanelComponents": [
                {
                    "type": "Image",
                    "props": {
                        "src": "condizionatore-baccheta",
                        "alt": "Animazione Condizionatore",
                        "className": "z-10 relative w-auto h-auto mt-16",
                        "containerClassName": "flex justify-center items-center flex-1"
                    }
                }
            ],
            "components": [
                {
                    "type": "LoadingSpinner",
                    "props": {
                        "text": "Attendi ancora qualche secondo",
                        "size": "medium"
                    },
                    "renderConditions": {
                        "isDefined": "report.data.loading"
                    }
                },
                {
                    "type": "ErrorMessage",
                    "props": {
                        "title": "Errore nella generazione del preventivo",
                        "stateProperty": "reportError",
                        "showWhen": "reportHasError",
                        "actionButtonText": "Riprova",
                        "actionButtonAction": "retrySimulation"
                    }
                }
            ]
        },
        {
            "id": "preventivo-risultato",
            "title": "Preventivo generato con successo",
            "step": 3,
            "fullPage": false,
            "showStepper": true,
            "showNavigation": true,
            "showBackgroundDecoration": true,
            "validationRules": {},
            "navigationHooks": {
                "beforeNext": "",
                "afterNext": "",
                "beforePrevious": "",
                "afterPrevious": ""
            },
            "navigationOverride": {
                "backButton": {
                    "label": "Stampa Preventivo",
                    "icon": "reader",
                    "iconPosition": "right",
                    "variant": "secondary",
                    "disabled": false,
                    "action": "report.openReport"
                },
                "nextButton": {
                    "label": "Invia report finale al cliente",
                    "icon": "envelope",
                    "iconPosition": "right",
                    "variant": "primary",
                    "disabled": false,
                    "action": "openSidebar"
                }
            },
            "leftPanelComponents": [
                {
                    "type": "Image",
                    "props": {
                        "src": "condizionatore-big",
                        "alt": "Condizionatore Completato",
                        "className": "z-10 relative w-auto h-auto mt-16",
                        "containerClassName": "flex justify-center items-center flex-1"
                    }
                }
            ],
            "components": [
                {
                    "type": "DescriptionBox",
                    "props": {
                        "title": "Il preventivo è stato generato con successo!",
                        "description": "I dati della simulazione sono stati elaborati e il report è disponibile."
                    }
                },
                {
                    "type": "ReportSummary",
                    "props": {}
                },
                {
                    "type": "DescriptionBox",
                    "props": {
                        "title": "Il suo investimento il suo futuro",
                        "description": "Ogni scelta fatta oggi si traduce in un risparmio concreto e in un futuro più sostenibile. Fai scoprire al cliente come i prodotti che ha scelto migliorano la sua vita quotidiana e offrono un ritorno economico che cresce nel tempo."
                    }
                },
                {
                    "type": "SummaryResults",
                    "props": {}
                },
                {
                    "type": "DescriptionBox",
                    "props": {
                        "title": "Racconta al cliente quali sono i potenziali benefici",
                        "titleSize": "base",
                        "description": "Se il cliente decide di confermare questa soluzione potrebbe ottenere i seguenti benefici:"
                    }
                },
                {
                    "type": "HorizontalBannerContainer",
                    "props": {
                        "banners": [
                            {
                                "title": "Benefici economici",
                                "icon": "savings",
                                "content": "Acquistare un climatizzatore di ultima generazione è una scelta economicamente vantaggiosa. Grazie alla tecnologia ad alta efficienza energetica, <b>questi dispositivi consumano fino al 40% in meno</b> rispetto ai modelli tradizionali, <b>con un<b><b class='text-secondary'> risparmio annuo che può superare i 400 euro</b><b> sulla bolletta elettrica.</b>"
                            },
                            {
                                "title": "Benefici ambientali",
                                "icon": "eco",
                                "content": "Questi modelli riducono notevolmente i consumi energetici, <b class='text-secondary'>emettendo fino a 400 kg in meno di CO₂ all’anno</b> <b>rispetto</b> ai vecchi impianti. <b>È l’equivalente della quantità di CO₂ assorbita in un anno da circa 25 alberi.</b> Utilizzando meno energia e refrigeranti a basso impatto ambientale, contribuiscono concretamente alla lotta contro il cambiamento climatico, <b>migliorando la qualità dell’aria e proteggendo l’ambiente.</b>"
                            }
                        ]
                    }
                },
                {
                    "type": "PromotionalBanner",
                    "props": {
                        "title": "Il cliente vuole ricevere dei dati più precisi sulle performance della sua abitazione?",
                        "description": "Le proiezioni relative ai benefici economici e ambientali visualizzate rappresentano delle stime indicative. Per un'analisi comparativa più precisa delle performance della sua abitazione consiglia di effettuare una simulazione con Lumiè Discovery..",
                        "buttonText": "Effettua il check-up energetico con Lumiè",
                        "buttonUrl": "https://simulatore-risparmio-energia.enel.it"
                    }
                },
                {
                    "type": "Divider",
                    "props": {
                        "color": "#c2cddd",
                        "spacing": "32px"
                    }
                },
                {
                    "type": "DisclaimerContainer",
                    "props": {
                        "className": "mt-6 mb-4",
                        "sections": [
                            "<b>* Il prezzo visualizzato è calcolato in base alla regione in cui si trova la casa del cliente.</b>",
                            "<b>**Sono disponibili diverse modalità di finanziamento.</b> Informa il cliente sui requisiti di accesso alle agevolazioni, sul periodo di validità e sulle spese ammissibili, facendo riferimento alla normativa vigente. Spiegagli eventuali TAN e TAEG applicati al finanziamento per aiutarlo a comprendere il costo finale del prodotto che desidera. Ricordagli inoltre di richiedere il documento 'Informazioni europee di base sul credito ai consumatori' (SECCI) e una copia del contratto, così avrà tutto il necessario per prendere una decisione informata sui costi e sulle condizioni.",
                            "<b>Nota importante sull’installazione del climatizzatore.</b> L’installazione del climatizzatore potrà essere effettuata solo se tutte le seguenti condizioni tecniche sono rispettate:",
                            "<ol class='list-decimal pl-4'><li>Le pareti da forare per il passaggio delle tubazioni sono in laterizio (mattone vuoto) e consentono fori di dimensioni massime pari a 8 cm di diametro e 40 cm di spessore.</li><li>Il dislivello tra l’unità interna ed esterna non supera i 3,5 metri.</li><li>L’unità esterna è installabile ad una quota inferiore a 3,5 metri da una superficie calpestabile (pian terreno, balcone, terrazzo  esclusi balconi a sbalzo).</li><li>È garantito il rispetto degli spazi minimi di installazione per ogni unità:<ul class='list-disc pl-4'><li>Unità interne: almeno 110 cm di larghezza e 50 cm di altezza.</li><li>Unità esterne mono/dual split: almeno 120 cm di larghezza e 105 cm di profondità.</li><li>Unità esterne trial split: almeno 130 cm di larghezza e 110 cm di profondità.</li></ul></li></ol>",
                            "<b>In assenza di una o più di queste condizioni, sarà necessario un sopralluogo tecnico aggiuntivo per verificare la fattibilità dell’installazione o proporre eventuali soluzioni alternative.</b>"
                        ]
                    }
                },
                {
                    "type": "SidebarForm",
                    "props": {
                        "onSubmitAction": "confirmLead"
                    }
                }
            ]
        },
        {
            "id": "invio-report",
            "title": "Creazione del report finale, ci siamo quasi!",
            "step": 3,
            "fullPage": false,
            "showStepper": true,
            "showNavigation": true,
            "showBackgroundDecoration": true,
            "validationRules": {},
            "navigationOverride": {},
            "navigationHooks": {
                "beforeNext": "",
                "afterNext": "",
                "beforePrevious": "",
                "afterPrevious": ""
            },
            "leftPanelComponents": [
                {
                    "type": "Image",
                    "props": {
                        "src": "condizionatore-baccheta",
                        "alt": "Animazione Condizionatore",
                        "className": "z-10 relative w-auto h-auto mt-16",
                        "containerClassName": "flex justify-center items-center flex-1"
                    }
                }
            ],
            "components": [
                {
                    "type": "LoadingSpinner",
                    "props": {
                        "text": "Attendi ancora qualche secondo",
                        "size": "medium"
                    },
                    "renderConditions": {
                        "isDefined": "lead.isLoading"
                    }
                }
            ]
        },
        {
            "id": "fine-simulazione",
            "title": "",
            "step": 0,
            "fullPage": true,
            "showStepper": false,
            "showNavigation": false,
            "showBackgroundDecoration": false,
            "validationRules": {},
            "navigationOverride": {},
            "navigationHooks": {
                "beforeNext": "",
                "afterNext": "",
                "beforePrevious": "",
                "afterPrevious": ""
            },
            "leftPanelComponents": [
                {
                    "type": "FinalMessage",
                    "props": {
                        "title": "Evviva! Il preventivo è stato creato con successo",
                        "onSendAction": "submitLead",
                        "onPrintAction": "report.openReport"
                    }
                }
            ],
            "components": []
        }
    ]
}